<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Brandon's Big Board 2026</title>

<style>
:root {
  --bg: #f4f6f8;
  --text: #111;
  --table-bg: white;
  --header-bg: #111;
  --header-text: white;
  --row-hover: #f1f1f1;
  --highlight: #e8eef7;
}

body.dark {
  --bg: #121212;
  --text: #e4e4e4;
  --table-bg: #1e1e1e;
  --header-bg: #000;
  --header-text: #fff;
  --row-hover: #2a2a2a;
  --highlight: #2c3e55;
}

body {
  font-family: Arial, sans-serif;
  margin: 40px;
  background-color: var(--bg);
  color: var(--text);
  transition: background 0.25s, color 0.25s;
}

h1 { text-align: center; }

.controls {
  text-align: center;
  margin-bottom: 20px;
}

select, input, button {
  padding: 8px;
  margin: 6px;
  font-size: 16px;
}

button {
  cursor: pointer;
  border-radius: 6px;
  border: none;
}

table {
  border-collapse: collapse;
  width: 100%;
  background: var(--table-bg);
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

th, td {
  padding: 10px;
  border-bottom: 1px solid #4442;
}

th {
  background-color: var(--header-bg);
  color: var(--header-text);
  position: sticky;
  top: 0;
  cursor: pointer;
  white-space: nowrap;
}

.arrow {
  margin-left: 6px;
  font-size: 12px;
}

tr:hover { background-color: var(--row-hover); }

.highlight-col {
  background-color: var(--highlight) !important;
}
</style>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>

<body>

<h1>Brandon's Big Board 2026</h1>

<div class="controls">

<button onclick="toggleDarkMode()">ðŸŒ™ Toggle Dark Mode</button>

<br>

<input type="text" id="searchBox" placeholder="Search players..." />

<select id="positionFilter">
  <option value="ALL">All Positions</option>
</select>

</div>

<table id="data-table">
  <thead></thead>
  <tbody></tbody>
</table>

<script>
const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ0uaGV-62aAS74y5I-HVKCtGd8l5vy0iaNOErDHjQBFXNt2kDKhAEUMRQDGckqQoJqjUtwnKqTWqgR/pub?gid=0&single=true&output=csv";

let tableData = [];
let headers = [];
let currentSortColumn = -1;
let sortAscending = true;
let posIndex = -1;

/* DARK MODE */
function toggleDarkMode(){
  document.body.classList.toggle("dark");
  localStorage.setItem("darkMode",
    document.body.classList.contains("dark"));
}

if(localStorage.getItem("darkMode")==="true"){
  document.body.classList.add("dark");
}

Papa.parse(csvUrl, {
  download: true,
  complete: function(results) {

    headers = results.data[1];
    tableData = results.data.slice(2).filter(r => r.length > 1);

    posIndex = headers.findIndex(h =>
      h.toLowerCase().includes("pos")
    );

    createHeaders();
    populateFilter();
    displayRows();
  }
});

function createHeaders() {
  const thead = document.querySelector("#data-table thead");
  const row = document.createElement("tr");

  headers.forEach((h, i) => {
    const th = document.createElement("th");

    const label = document.createElement("span");
    label.textContent = h;

    const arrow = document.createElement("span");
    arrow.className = "arrow";

    th.appendChild(label);
    th.appendChild(arrow);

    th.onclick = () => {
      sortTable(i);
      updateArrows();
    };

    row.appendChild(th);
  });

  thead.appendChild(row);
}

function sortTable(col) {
  if (currentSortColumn === col) {
    sortAscending = !sortAscending;
  } else {
    currentSortColumn = col;
    sortAscending = true;
  }

  tableData.sort((a,b)=>{
    let A = a[col];
    let B = b[col];

    let numA = parseFloat(A);
    let numB = parseFloat(B);

    if(!isNaN(numA) && !isNaN(numB)){
      return sortAscending ? numA-numB : numB-numA;
    }
    return sortAscending
      ? A.localeCompare(B)
      : B.localeCompare(A);
  });

  displayRows();
  highlightColumn(col);
}

function updateArrows(){
  document.querySelectorAll(".arrow").forEach((a,i)=>{
    a.textContent = i===currentSortColumn
      ? (sortAscending ? "â–²" : "â–¼")
      : "";
  });
}

function populateFilter(){
  if(posIndex === -1) return;

  const set = new Set();
  tableData.forEach(r=>set.add(r[posIndex]));

  const filter = document.getElementById("positionFilter");

  set.forEach(p=>{
    const opt = document.createElement("option");
    opt.value = p;
    opt.textContent = p;
    filter.appendChild(opt);
  });

  filter.onchange = displayRows;
}

document.getElementById("searchBox").addEventListener("input", displayRows);

function displayRows(){
  const tbody = document.querySelector("#data-table tbody");
  tbody.innerHTML="";

  const pos = document.getElementById("positionFilter").value;
  const search = document.getElementById("searchBox").value.toLowerCase();

  tableData.forEach(r=>{
    if(posIndex !== -1 && pos !== "ALL" && r[posIndex] !== pos) return;
    if(search && !r.join(" ").toLowerCase().includes(search)) return;

    const tr=document.createElement("tr");
    r.forEach(c=>{
      const td=document.createElement("td");
      td.textContent=c;
      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });

  if(currentSortColumn !== -1){
    highlightColumn(currentSortColumn);
  }
}

function highlightColumn(colIndex) {
  document.querySelectorAll(".highlight-col").forEach(cell =>
    cell.classList.remove("highlight-col")
  );

  const header = document.querySelectorAll("#data-table th")[colIndex];
  if (header) header.classList.add("highlight-col");

  document.querySelectorAll("#data-table tbody tr").forEach(row => {
    const cell = row.children[colIndex];
    if (cell) cell.classList.add("highlight-col");
  });
}
</script>

</body>
</html>
