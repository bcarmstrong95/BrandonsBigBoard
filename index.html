<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Brandon's Big Board</title>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>

<style>
body{
  background:black;
  color:white;
  font-family:Arial, sans-serif;
  margin:20px;
}

/* TABLE WRAPPER */
.table-wrapper{
  overflow:auto;
  max-height:75vh;
  border:1px solid #222;
}

table{
  border-collapse:separate;
  border-spacing:0;
  width:100%;
  min-width:max-content;
  table-layout:fixed;
}

th, td{
  padding:8px 14px;
  text-align:center;
  white-space:nowrap;
}

/* HEADER */
th{
  background:#4169E1;
  cursor:pointer;
  position:sticky;
  top:0;
  z-index:1000;
  transition:background .2s ease;
}

th:hover{
  background:#3157c7;
}

th .arrow{
  display:inline-block;
  margin-left:6px;
  opacity:0;
  transition:transform .25s ease, opacity .2s ease;
}

th.sorted .arrow{ opacity:1; }
th.sorted.desc .arrow{ transform:rotate(180deg); }

.sorted-column{
  background:#162b55 !important;
}

/* COLUMN WIDTHS */
th:nth-child(1), td:nth-child(1){
  width:260px;
  min-width:260px;
  text-align:left;
}

th:nth-child(2), td:nth-child(2){
  width:90px;
}

th:nth-child(3), td:nth-child(3){
  width:110px;
}

/* Sticky body columns */
td:nth-child(1){
  position:sticky;
  left:0;
  background:#000;
  z-index:900;
}

td:nth-child(2){
  position:sticky;
  left:260px;
  background:#000;
  z-index:901;
}

td:nth-child(3){
  position:sticky;
  left:350px; /* 260 + 90 */
  background:#000;
  z-index:902;
  box-shadow:6px 0 10px rgba(0,0,0,.7);
}

/* Sticky header columns */
th:nth-child(1){ left:0; z-index:1100; }
th:nth-child(2){ left:260px; z-index:1099; }
th:nth-child(3){ left:350px; z-index:1098; }

/* Row striping */
tbody tr:nth-child(odd){ background:#000; }
tbody tr:nth-child(even){ background:#111; }
tbody tr:hover{ background:#1a1a1a; }

tbody tr:nth-child(even) td:nth-child(-n+3){ background:#111; }
tbody tr:hover td:nth-child(-n+3){ background:#1a1a1a; }

/* POSITION COLORS */
.edge-row td { color:orange; font-weight:600; }
.dt-row td { color:#40e0d0; font-weight:600; }
.cb-row td { color:red; font-weight:600; }
.s-row td { color:#ff1493; font-weight:600; }
.te-row td { color:purple; font-weight:600; }
.rb-row td { color:#006400; font-weight:600; }
.wr-row td { color:#b8860b; font-weight:600; }
.lb-row td { color:#4169E1; font-weight:600; }
.ot-row td { color:yellow; font-weight:600; }
.iol-row td { color:#00ff00; font-weight:600; }

.school-logo{
  height:22px;
  vertical-align:middle;
}
</style>
</head>

<body>

<h1>Brandon's Big Board 2026</h1>

<div class="table-wrapper">
<table id="data-table">
  <thead></thead>
  <tbody></tbody>
</table>
</div>

<script>

const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ0uaGV-62aAS74y5I-HVKCtGd8l5vy0iaNOErDHjQBFXNt2kDKhAEUMRQDGckqQoJqjUtwnKqTWqgR/pub?gid=0&single=true&output=csv";

let originalData=[];
let filteredData=[];
let headers=[];
let posIndex=-1;
let schoolIndex=-1;
let currentSort=-1;
let sortAsc=true;

Papa.parse(csvUrl,{
  download:true,
  skipEmptyLines:true,
  complete:function(results){

    headers = results.data[1].map(h=>h.trim());
    originalData = results.data.slice(2).filter(r=>r.length===headers.length);
    filteredData = [...originalData];

    posIndex = headers.findIndex(h=>h.toLowerCase().includes("pos"));
    schoolIndex = headers.findIndex(h=>h.toLowerCase().includes("school"));

    createHeaders();
    displayRows();

    const fortyIndex = headers.findIndex(h => h.toLowerCase().includes("40"));
    if(fortyIndex !== -1){
      sortAsc = true;
      sortTable(fortyIndex);
    }
  }
});

function createHeaders(){
  const thead=document.querySelector("#data-table thead");
  thead.innerHTML="";
  const row=document.createElement("tr");

  headers.forEach((h,i)=>{
    const th=document.createElement("th");
    th.innerHTML=h+' <span class="arrow">â–²</span>';
    th.onclick=()=>sortTable(i);
    row.appendChild(th);
  });

  thead.appendChild(row);
}

function displayRows(){
  const tbody=document.querySelector("#data-table tbody");
  tbody.innerHTML="";

  filteredData.forEach(r=>{
    const tr=document.createElement("tr");

    if(posIndex>=0){
      const p=r[posIndex];
      if(p==="EDGE") tr.classList.add("edge-row");
      if(p==="DT") tr.classList.add("dt-row");
      if(p==="CB") tr.classList.add("cb-row");
      if(p==="S") tr.classList.add("s-row");
      if(p==="TE") tr.classList.add("te-row");
      if(p==="RB") tr.classList.add("rb-row");
      if(p==="WR") tr.classList.add("wr-row");
      if(p==="LB") tr.classList.add("lb-row");
      if(p==="OT") tr.classList.add("ot-row");
      if(p==="IOL") tr.classList.add("iol-row");
    }

    r.forEach((c,i)=>{
      const td=document.createElement("td");

      if(i===schoolIndex && c==="Alabama"){
        td.innerHTML='<img src="bama.svg" class="school-logo">';
      } else {
        td.textContent=c;
      }

      tr.appendChild(td);
    });

    tbody.appendChild(tr);
  });
}

function parseValue(val){
  if(!val) return 0;

  if(val.includes("'")){
    const parts=val.split("'");
    return parseInt(parts[0])*12+parseInt(parts[1]);
  }

  const num=parseFloat(val);
  if(!isNaN(num)) return num;

  return val.toString().toLowerCase();
}

function sortTable(col){
  if(currentSort===col){
    sortAsc=!sortAsc;
  } else {
    sortAsc=true;
    currentSort=col;
  }

  filteredData.sort((a,b)=>{
    const v1=parseValue(a[col]);
    const v2=parseValue(b[col]);

    if(v1<v2) return sortAsc?-1:1;
    if(v1>v2) return sortAsc?1:-1;
    return 0;
  });

  document.querySelectorAll("th").forEach(th=>{
    th.classList.remove("sorted","desc","sorted-column");
  });

  const th=document.querySelectorAll("th")[col];
  th.classList.add("sorted","sorted-column");
  if(!sortAsc) th.classList.add("desc");

  displayRows();
}

</script>

</body>
</html>
