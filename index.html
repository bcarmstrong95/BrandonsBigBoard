<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Brandon's Big Board</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>

<style>
body{background:black;color:white;font-family:Arial;margin:0;}
.hero-banner{background:linear-gradient(135deg,#0a0a0a,#1a0a0a);border-top:1px solid #222;border-bottom:1px solid #222;padding:30px 20px;text-align:center;}
.hero-content h1{font-size:36px;margin:0;letter-spacing:2px;font-weight:700;}
.hero-content h2{font-size:22px;margin:10px 0;color:#4169E1;font-weight:600;}
.meta-info{margin-top:12px;font-size:15px;color:#ccc;}
.top-logos{display:flex;justify-content:center;align-items:center;gap:80px;padding:40px 0 20px 0;}
.top-logos img{height:285px;object-fit:contain;}
.table-wrapper{overflow:auto;max-height:75vh;margin:20px;}
table{border-collapse:separate;border-spacing:0;width:100%;min-width:max-content;}
th,td{padding:8px 14px;text-align:center;white-space:nowrap;}
th{background:#4169E1;cursor:pointer;position:sticky;top:0;z-index:1000;}
th .arrow{margin-left:6px;font-weight:bold;}
th.sorted{background:#162b55!important;}
.active-col{background:#1c1c1c!important;}
.school-logo{height:70px;width:70px;object-fit:contain;vertical-align:middle;}
.logo-michigan,.logo-osu{height:49px;width:49px;}
.logo-bama{height:42px;width:42px;}
</style>
</head>

<body>

<div class="hero-banner">
<h1>Brandon's Big Board 2026</h1>
<h2>2026 NFL Draft Database</h2>
<div class="meta-info">Prospects: <span id="prospectCount">Loading...</span></div>
</div>

<div class="top-logos">
<img src="comby.png">
<img src="NFLLogo.png">
<img src="Draft26.jpg">
</div>

<div class="table-wrapper">
<table id="data-table">
<thead></thead>
<tbody></tbody>
</table>
</div>

<script>
const csvUrl="https://docs.google.com/spreadsheets/d/e/2PACX-1vQ0uaGV-62aAS74y5I-HVKCtGd8l5vy0iaNOErDHjQBFXNt2kDKhAEUMRQDGckqQoJqjUtwnKqTWqgR/pub?gid=0&single=true&output=csv";

let headers=[], originalData=[], filteredData=[];
let currentSort=-1, sortAsc=true;
let heightIndex=-1;

const schoolLogos={
  "Michigan":{src:"michigan.png", class:"logo-michigan"},
  "Ohio St.":{src:"osu1.png", class:"logo-osu"},
  "Alabama":{src:"bama.svg", class:"logo-bama"},
  "Indiana":{src:"iu1.png", class:""},
  "LSU":{src:"lsu2.png", class:""},
  "Iowa":{src:"iowa2.png", class:""}
};

/* ---------- Convert decimal feet to football fraction ---------- */
function decimalFeetToFraction(val){
    if(!val || val==="-" ) return val;

    if(val.includes("'")) return val; // already formatted

    let num=parseFloat(val);
    if(isNaN(num)) return val;

    let totalInches = num * 12;
    let feet = Math.floor(totalInches / 12);
    let inchesDecimal = totalInches - (feet * 12);

    let wholeInches = Math.floor(inchesDecimal);
    let fraction = inchesDecimal - wholeInches;

    let denom = 8;
    let numerator = Math.round(fraction * denom);

    if(numerator === 0){
        return feet + "'" + wholeInches;
    }

    if(numerator === denom){
        wholeInches += 1;
        numerator = 0;
    }

    if(numerator === 0){
        return feet + "'" + wholeInches;
    }

    return feet + "'" + wholeInches + " " + numerator + "/" + denom;
}

/* ---------- Convert height string to numeric inches for sorting ---------- */
function heightToInches(val){
    if(!val || val==="-" ) return null;

    if(!val.includes("'")){
        return parseFloat(val) * 12;
    }

    let parts=val.split("'");
    let feet=parseFloat(parts[0]);
    let inchesPart=parts[1].trim();

    let inches=0;

    if(inchesPart.includes("/")){
        let split=inchesPart.split(" ");
        let whole=parseFloat(split[0])||0;
        let frac=0;
        if(split[1]){
            let f=split[1].split("/");
            frac=parseFloat(f[0])/parseFloat(f[1]);
        }
        inches=whole+frac;
    } else {
        inches=parseFloat(inchesPart)||0;
    }

    return (feet*12)+inches;
}

Papa.parse(csvUrl,{
download:true,
skipEmptyLines:true,
complete:function(results){
headers=results.data[1].map(h=>h.trim());
heightIndex=headers.findIndex(h=>h.toLowerCase()==="height");
originalData=results.data.slice(2).filter(r=>r.length===headers.length);

originalData.forEach(row=>{
if(heightIndex>-1){
row[heightIndex]=decimalFeetToFraction(row[heightIndex]);
}
});

filteredData=[...originalData];
createHeaders();
displayRows();
document.getElementById("prospectCount").textContent=originalData.length;
}
});

function sortTable(col){
if(currentSort===col){sortAsc=!sortAsc;}
else{currentSort=col;sortAsc=true;}

filteredData.sort((a,b)=>{

if(col===heightIndex){
let v1=heightToInches(a[col]);
let v2=heightToInches(b[col]);
if(v1===null) return 1;
if(v2===null) return -1;
return sortAsc ? v1-v2 : v2-v1;
}

let n1=parseFloat(a[col]);
let n2=parseFloat(b[col]);
if(!isNaN(n1)&&!isNaN(n2)){
return sortAsc?n1-n2:n2-n1;
}

return sortAsc
? a[col].localeCompare(b[col])
: b[col].localeCompare(a[col]);
});

document.querySelectorAll("th").forEach(th=>{
th.classList.remove("sorted");
th.querySelector(".arrow").textContent="";
});

const active=document.querySelectorAll("th")[col];
active.classList.add("sorted");
active.querySelector(".arrow").textContent=sortAsc?"▲":"▼";

displayRows();
}

function displayRows(){
const tbody=document.querySelector("#data-table tbody");
tbody.innerHTML="";
filteredData.forEach(r=>{
const tr=document.createElement("tr");
r.forEach((c,i)=>{
const td=document.createElement("td");

if(headers[i].toLowerCase().includes("school") && schoolLogos[c]){
const logo=schoolLogos[c];
td.innerHTML=`<img src="${logo.src}" class="school-logo ${logo.class}">`;
}else{
td.textContent=c;
}

if(i===currentSort) td.classList.add("active-col");
tr.appendChild(td);
});
tbody.appendChild(tr);
});
}

function createHeaders(){
const thead=document.querySelector("#data-table thead");
const row=document.createElement("tr");
headers.forEach((h,i)=>{
const th=document.createElement("th");
th.innerHTML=h+' <span class="arrow"></span>';
th.addEventListener("click",()=>sortTable(i));
row.appendChild(th);
});
thead.appendChild(row);
}
</script>

</body>
</html>
