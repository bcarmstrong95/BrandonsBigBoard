<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Brandon's Big Board</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>

<style>
body{
  background:black;
  color:white;
  font-family:Arial, sans-serif;
  margin:0;
}

/* ---------- HERO ---------- */

.hero-banner{
  background:linear-gradient(135deg,#0a0a0a,#1a0a0a);
  border-top:1px solid #222;
  border-bottom:1px solid #222;
  padding:30px 20px;
  text-align:center;
}

.hero-content h1{
  font-size:36px;
  margin:0;
  letter-spacing:2px;
  font-weight:700;
}

.hero-content h2{
  font-size:22px;
  margin:10px 0;
  color:#4169E1;
  font-weight:600;
}

.meta-info{
  margin-top:12px;
  font-size:15px;
  color:#ccc;
}

/* ---------- LOGOS ---------- */

.top-logos{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:80px;
  padding:40px 0 20px 0;
}

.top-logos img{
  height:285px;
  object-fit:contain;
}

/* ---------- FILTERS ---------- */

.filter-bar{
  display:flex;
  justify-content:center;
  gap:20px;
  padding:20px;
}

.filter-bar input,
.filter-bar select{
  padding:8px 12px;
  font-size:14px;
  border-radius:4px;
  border:1px solid #333;
  background:#111;
  color:white;
}

/* ---------- TABLE ---------- */

.table-wrapper{
  overflow:auto;
  max-height:75vh;
  margin:20px;
}

table{
  border-collapse:separate;
  border-spacing:0;
  width:100%;
  min-width:max-content;
  table-layout:auto;
}

th, td{
  padding:8px 14px;
  text-align:center;
  white-space:nowrap;
}

th{
  background:#4169E1;
  cursor:pointer;
  position:sticky;
  top:0;
  z-index:1000;
  user-select:none;
}

th .arrow{
  margin-left:6px;
  font-weight:bold;
}

th.sorted{
  background:#162b55 !important;
}

.active-col{
  background:#1c1c1c !important;
}

/* Sticky first 3 columns */

th:nth-child(1), td:nth-child(1){ width:90px; }
th:nth-child(2), td:nth-child(2){ width:90px; }

th:nth-child(3), td:nth-child(3){
  text-align:left;
}

td:nth-child(1){ position:sticky; left:0; background:#000; z-index:5; }
td:nth-child(2){ position:sticky; left:90px; background:#000; z-index:5; }
td:nth-child(3){ position:sticky; left:180px; background:#000; z-index:5; }

/* School logos */

.school-logo{
  height:70px;
  width:70px;
  object-fit:contain;
  vertical-align:middle;
}

/* Position shading */

.pos-light { background:#111; }
.pos-dark  { background:#1a1a1a; }

/* ---------- MOBILE ---------- */

@media (max-width: 768px){
  .top-logos{
    flex-direction:row !important;
    justify-content:center;
    gap:20px;
  }

  .top-logos img{
    height:70px !important;
  }

  .filter-bar{
    flex-direction:column;
    align-items:center;
  }

  .table-wrapper{
    overflow-x:auto;
    overflow-y:auto;
    max-height:none;
    margin:10px;
  }

  table{
    table-layout:auto !important;
    width:auto !important;
    min-width:900px !important;
  }

  th, td{
    position:static !important;
    min-width:120px !important;
  }
}
</style>
</head>

<body>

<div class="hero-banner">
  <div class="hero-content">
    <h1>Brandon's Big Board 2026</h1>
    <h2>2026 NFL Draft Database</h2>
    <div class="meta-info">
      Prospects: <span id="prospectCount">Loading...</span>
    </div>
  </div>
</div>

<div class="top-logos">
  <img src="comby.png">
  <img src="NFLLogo.png">
  <img src="Draft26.jpg">
</div>

<div class="filter-bar">
  <input type="text" id="searchInput" placeholder="Search players...">
  <select id="positionFilter">
    <option value="">All Positions</option>
  </select>
</div>

<div class="table-wrapper">
<table id="data-table">
  <thead></thead>
  <tbody></tbody>
</table>
</div>

<script>
const csvUrl="https://docs.google.com/spreadsheets/d/e/2PACX-1vQ0uaGV-62aAS74y5I-HVKCtGd8l5vy0iaNOErDHjQBFXNt2kDKhAEUMRQDGckqQoJqjUtwnKqTWqgR/pub?gid=0&single=true&output=csv";

let originalData=[], filteredData=[], headers=[];
let posIndex=-1, schoolIndex=-1;
let heightIndex=-1, handIndex=-1, armIndex=-1, wingspanIndex=-1, fortyIndex=-1;
let currentSort=-1, sortAsc=true;

const schoolLogos={
  "Michigan":"michigan.png",
  "Indiana":"iu1.png",
  "Ohio St.":"osu1.png",
  "LSU":"lsu2.png",
  "Iowa":"iowa2.png",
  "Alabama":"bama.svg"
};

/* -------- FRACTION LOGIC -------- */

function decimalToFraction(num){
  const whole=Math.floor(num);
  const frac=num-whole;
  const denominators=[2,4,8,16];
  for(let d of denominators){
    let n=Math.round(frac*d);
    if(Math.abs(frac - n/d)<0.02 && n!==0){
      return whole+" "+n+"/"+d;
    }
  }
  return whole.toString();
}

function fractionToDecimal(val){
  val=val.replace(/"/g,"").trim();
  if(val.includes("/")){
    const parts=val.split(" ");
    const whole=parseFloat(parts[0])||0;
    const frac=parts[1]?.split("/")||[];
    if(frac.length===2){
      return whole+(parseFloat(frac[0])/parseFloat(frac[1]));
    }
  }
  return parseFloat(val);
}

function measurementToNumber(val){
  if(!val || val==="-" || val==="") return null;
  if(val.includes("'")){
    const parts=val.split("'");
    const feet=parseFloat(parts[0]);
    const inches=fractionToDecimal(parts[1]);
    return feet*12+inches;
  }
  return fractionToDecimal(val);
}

function formatMeasurement(val){
  if(!val || val==="-" || val==="") return val;
  if(val.includes("/")) return val;

  if(val.includes("'")){
    const parts=val.split("'");
    const feet=parseFloat(parts[0]);
    const inches=parseFloat(parts[1]);
    if(!isNaN(inches)){
      return feet+"'"+decimalToFraction(inches)+'"';
    }
  }

  const num=parseFloat(val);
  if(!isNaN(num)) return decimalToFraction(num)+'"';
  return val;
}

function parseValue(val,col){
  if(!val || val==="-" || val==="") return null;
  if([heightIndex,handIndex,armIndex,wingspanIndex].includes(col)){
    return measurementToNumber(val);
  }
  const num=parseFloat(val);
  if(!isNaN(num)) return num;
  return val.toLowerCase();
}

/* -------- CSV LOAD -------- */

Papa.parse(csvUrl,{
  download:true,
  skipEmptyLines:true,
  complete:function(results){
    headers=results.data[1].map(h=>h.trim());
    originalData=results.data.slice(2).filter(r=>r.length===headers.length);
    filteredData=[...originalData];

    posIndex=headers.findIndex(h=>h.toLowerCase().includes("pos"));
    schoolIndex=headers.findIndex(h=>h.toLowerCase().includes("school"));
    heightIndex=headers.findIndex(h=>h.toLowerCase().includes("height"));
    handIndex=headers.findIndex(h=>h.toLowerCase().includes("hand"));
    armIndex=headers.findIndex(h=>h.toLowerCase().includes("arm"));
    wingspanIndex=headers.findIndex(h=>h.toLowerCase().includes("wingspan"));
    fortyIndex=headers.findIndex(h=>h==="40");

    document.getElementById("prospectCount").textContent=originalData.length;
    populatePositions();
    createHeaders();
    displayRows();
  }
});

/* -------- SORT -------- */

function sortTable(col){
  if(currentSort===col){ sortAsc=!sortAsc; }
  else{ currentSort=col; sortAsc=true; }

  filteredData.sort((a,b)=>{
    const v1=parseValue(a[col],col);
    const v2=parseValue(b[col],col);

    if(v1===null) return 1;
    if(v2===null) return -1;
    if(col===fortyIndex) return v1-v2;

    if(typeof v1==="number" && typeof v2==="number"){
      return sortAsc ? v1-v2 : v2-v1;
    }

    return sortAsc
      ? v1.toString().localeCompare(v2)
      : v2.toString().localeCompare(v1);
  });

  document.querySelectorAll("th").forEach(th=>{
    th.classList.remove("sorted");
    th.querySelector(".arrow").textContent="";
  });

  const activeTh=document.querySelectorAll("th")[col];
  activeTh.classList.add("sorted");
  activeTh.querySelector(".arrow").textContent=sortAsc?"▲":"▼";

  displayRows();
}

/* -------- DISPLAY -------- */

function displayRows(){
  const tbody=document.querySelector("#data-table tbody");
  tbody.innerHTML="";

  filteredData.forEach(r=>{
    const tr=document.createElement("tr");

    r.forEach((c,i)=>{
      const td=document.createElement("td");

      if(i===schoolIndex && schoolLogos[c]){
        td.innerHTML=`<img src="${schoolLogos[c]}" class="school-logo">`;
      }
      else if([heightIndex,handIndex,armIndex,wingspanIndex].includes(i)){
        td.textContent=formatMeasurement(c);
      }
      else{
        td.textContent=c;
      }

      if(i===currentSort) td.classList.add("active-col");
      tr.appendChild(td);
    });

    tbody.appendChild(tr);
  });

  document.getElementById("prospectCount").textContent=filteredData.length;
}

/* -------- FILTERS -------- */

document.getElementById("searchInput").addEventListener("input",function(){
  const search=this.value.toLowerCase();
  filteredData=originalData.filter(r=>r.join(" ").toLowerCase().includes(search));
  displayRows();
});

document.getElementById("positionFilter").addEventListener("change",function(){
  const pos=this.value;
  filteredData=pos
    ? originalData.filter(r=>r[posIndex]===pos)
    : [...originalData];
  displayRows();
});

function createHeaders(){
  const thead=document.querySelector("#data-table thead");
  const row=document.createElement("tr");
  headers.forEach((h,i)=>{
    const th=document.createElement("th");
    th.innerHTML=h+' <span class="arrow"></span>';
    th.addEventListener("click",()=>sortTable(i));
    row.appendChild(th);
  });
  thead.appendChild(row);
}

function populatePositions(){
  const select=document.getElementById("positionFilter");
  const positions=[...new Set(originalData.map(r=>r[posIndex]))].sort();
  positions.forEach(p=>{
    const opt=document.createElement("option");
    opt.value=p;
    opt.textContent=p;
    select.appendChild(opt);
  });
}
</script>

</body>
</html>
