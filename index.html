<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Brandon's Big Board</title>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>

<style>
body{
  background-color:black;
  color:white;
  font-family:Arial, sans-serif;
  margin:20px;
}

h1{
  text-align:center;
  margin-bottom:10px;
}

.logo-container{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:40px;
  margin-bottom:20px;
}

.logo-container img{
  height:150px;
}

.controls{
  text-align:center;
  margin-bottom:15px;
}

input, select{
  padding:6px;
  margin:5px;
  font-size:14px;
  background:#111;
  color:white;
  border:1px solid #444;
}

table{
  border-collapse:collapse;
  width:100%;
}

th, td{
  padding:8px;
  text-align:center;
  border:none;
}

th{
  background-color:#4169E1;
  cursor:pointer;
  position:sticky;
  top:0;
  z-index:2;
}

th:hover{
  background-color:#3154b3;
}

th .arrow{
  margin-left:5px;
}

td:first-child{
  background-color:#4169E1;
  font-weight:bold;
}

.sorted-column{
  background-color:#222 !important;
}

tbody tr:hover{
  background-color:#1a1a1a;
}

tbody tr:nth-child(even){
  background-color:#111;
}
</style>
</head>

<body>

<h1>Brandon Armstrong's 2026 NFL Big Board</h1>

<div class="logo-container">
  <img src="NFLLogo.png" alt="NFL Logo">
  <img src="Draft26.jpg" alt="2026 Draft Logo">
</div>

<div class="controls">
  <input type="text" id="searchBox" placeholder="Search players...">
  <select id="positionFilter">
    <option value="ALL">All Positions</option>
  </select>
</div>

<table id="data-table">
  <thead></thead>
  <tbody></tbody>
</table>

<script>

const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ0uaGV-62aAS74y5I-HVKCtGd8l5vy0iaNOErDHjQBFXNt2kDKhAEUMRQDGckqQoJqjUtwnKqTWqgR/pub?gid=0&single=true&output=csv";

let tableData = [];
let headers = [];
let currentSortColumn = -1;
let sortAscending = true;
let posIndex = -1;

const columnDescriptions = {
  "B#": "NFL Expert Brandon Armstrong's Big Board Ranking",
  "C#": "Consensus Ranking according to NFLMockDraftDatabase.com",
  "Name": "Player's Name",
  "POS": "Player's Primary Position",
  "School": "The university the player is being drafted from",
  "Height": "Player height (converted to total inches for sorting)",
  "Weight": "Player weight in pounds",
  "Age": "Player age at time of draft",
  "Hand": "Hand measurement in inches (supports fractions & decimals)",
  "Arm": "Arm length in inches (supports fractions & decimals)",
  "PFN": "Impact Score from ProFootballNetwork.com",
  "PFF": "Most recent season grade from ProFootballFocus.com",
  "NFLDB": "Prospect grade from NFLDraftBuzz.com",
  "AVG": "Average of PFN, PFF & NFLDB"
};

Papa.parse(csvUrl,{
  download:true,
  skipEmptyLines:true,
  complete:function(results){

    // Grab first row as headers safely
    headers = results.data[0].map(h => h.trim());

    tableData = results.data.slice(1)
      .filter(r => r.length > 1);

    posIndex = headers.findIndex(h => 
      h.toLowerCase().includes("pos")
    );

    createHeaders();
    populateFilter();
    displayRows();
  }
});

function createHeaders(){
  const thead = document.querySelector("#data-table thead");
  thead.innerHTML="";
  const row = document.createElement("tr");

  headers.forEach((h,i)=>{
    const th=document.createElement("th");

    const label=document.createElement("span");
    label.textContent=h;

    const arrow=document.createElement("span");
    arrow.className="arrow";

    th.appendChild(label);
    th.appendChild(arrow);

    if(columnDescriptions[h]){
      th.title = columnDescriptions[h];
    }

    th.onclick=()=>{
      sortTable(i);
      updateArrows();
      highlightColumn();
    };

    row.appendChild(th);
  });

  thead.appendChild(row);
}

function parseHeight(val){
  if(!val) return 0;
  val = val.toString().trim();
  const match = val.match(/^(\d+)[-'](\d+(\.\d+)?)$/);
  if(match){
    return parseFloat(match[1])*12 + parseFloat(match[2]);
  }
  return parseFloat(val) || 0;
}

function parseMeasurement(val){
  if(!val) return 0;
  val = val.toString().trim();

  let mixed = val.match(/^(\d+)\s+(\d+)\/(\d+)$/);
  if(mixed){
    return parseFloat(mixed[1]) +
           (parseFloat(mixed[2]) / parseFloat(mixed[3]));
  }

  let fraction = val.match(/^(\d+)\/(\d+)$/);
  if(fraction){
    return parseFloat(fraction[1]) /
           parseFloat(fraction[2]);
  }

  let decimal = parseFloat(val);
  return isNaN(decimal) ? 0 : decimal;
}

function sortTable(col){

  if(currentSortColumn===col){
    sortAscending=!sortAscending;
  } else{
    currentSortColumn=col;
    sortAscending=true;
  }

  const headerName=headers[col].toLowerCase();

  tableData.sort((a,b)=>{

    let A=a[col]||"";
    let B=b[col]||"";

    if(headerName.includes("height")){
      A=parseHeight(A);
      B=parseHeight(B);
      return sortAscending?A-B:B-A;
    }

    if(headerName.includes("hand")||headerName.includes("arm")){
      A=parseMeasurement(A);
      B=parseMeasurement(B);
      return sortAscending?A-B:B-A;
    }

    if(!isNaN(parseFloat(A)) && !isNaN(parseFloat(B))){
      return sortAscending
        ? parseFloat(A)-parseFloat(B)
        : parseFloat(B)-parseFloat(A);
    }

    return sortAscending
      ? A.toString().localeCompare(B.toString())
      : B.toString().localeCompare(A.toString());
  });

  displayRows();
}

function updateArrows(){
  document.querySelectorAll("#data-table th").forEach((th,i)=>{
    const arrow=th.querySelector(".arrow");
    arrow.textContent = i===currentSortColumn
      ? (sortAscending?"▲":"▼")
      : "";
  });
}

function highlightColumn(){
  document.querySelectorAll("td,th").forEach(cell=>{
    cell.classList.remove("sorted-column");
  });

  if(currentSortColumn===-1) return;

  document.querySelectorAll("#data-table tr").forEach(row=>{
    if(row.children[currentSortColumn]){
      row.children[currentSortColumn]
         .classList.add("sorted-column");
    }
  });
}

function populateFilter(){
  if(posIndex===-1) return;

  const set=new Set();
  tableData.forEach(r=>set.add(r[posIndex]));

  const filter=document.getElementById("positionFilter");

  set.forEach(p=>{
    const opt=document.createElement("option");
    opt.value=p;
    opt.textContent=p;
    filter.appendChild(opt);
  });

  filter.onchange=displayRows;
}

document.getElementById("searchBox")
  .addEventListener("input",displayRows);

function displayRows(){
  const tbody=document.querySelector("#data-table tbody");
  tbody.innerHTML="";

  const pos=document.getElementById("positionFilter").value;
  const search=document.getElementById("searchBox").value.toLowerCase();

  tableData.forEach(r=>{
    if(posIndex!==-1 && pos!=="ALL" && r[posIndex]!==pos) return;
    if(search && !r.join(" ").toLowerCase().includes(search)) return;

    const tr=document.createElement("tr");

    r.forEach(c=>{
      const td=document.createElement("td");
      td.textContent=c;
      tr.appendChild(td);
    });

    tbody.appendChild(tr);
  });

  highlightColumn();
}

</script>

</body>
</html>
