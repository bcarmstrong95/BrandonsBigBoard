<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Brandon's Big Board 2026</title>

<style>
/* (ALL YOUR CSS REMAINS EXACTLY THE SAME — unchanged) */
body {
  font-family: Arial, sans-serif;
  margin: 40px;
  background-color: #000;
  color: white;
}

h1 { text-align: center; }

.logo-row {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 40px;
  margin-bottom: 20px;
}

.logo-row img {
  height: 150px;
}

select, input {
  padding: 8px;
  margin-bottom: 15px;
  font-size: 16px;
}

table {
  border-collapse: collapse;
  width: 100%;
  background: #111;
  box-shadow: 0 2px 6px rgba(0,0,0,0.5);
}

th, td {
  padding: 10px;
  border-bottom: 1px solid #333;
  text-align: left;
}

th {
  background-color: #4169E1;
  color: white;
  position: sticky;
  top: 0;
  cursor: pointer;
  white-space: nowrap;
}

td:first-child {
  background-color: #4169E1;
  color: white;
}

th:hover {
  background-color: #355acb;
}

.arrow {
  margin-left: 6px;
  font-size: 12px;
}

.sorted-column {
  background-color: rgba(65,105,225,0.25);
}

tr:hover { background-color: #222; }

th[title]:hover {
  background-color: #355acb;
  cursor: pointer;
  position: relative;
}

th[title]:hover::after {
  content: attr(title);
  position: absolute;
  top: -30px;
  left: 0;
  background-color: rgba(0, 0, 0, 0.8);
  color: #fff;
  padding: 5px;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  z-index: 1000;
}
</style>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>

<body>

<h1>Brandon's Big Board 2026</h1>

<div class="logo-row">
  <img src="NFLLogo.png" alt="NFL Logo">
  <img src="Draft26.jpg" alt="NFL Draft 2026">
</div>

<label><strong>Search:</strong></label><br>
<input type="text" id="searchBox" placeholder="Type to search players..." />

<br><br>

<label><strong>Filter by Position:</strong></label><br>
<select id="positionFilter">
  <option value="ALL">All Positions</option>
</select>

<br><br>

<table id="data-table">
  <thead></thead>
  <tbody></tbody>
</table>

<script>
const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ0uaGV-62aAS74y5I-HVKCtGd8l5vy0iaNOErDHjQBFXNt2kDKhAEUMRQDGckqQoJqjUtwnKqTWqgR/pub?gid=0&single=true&output=csv";

let tableData = [];
let headers = [];
let currentSortColumn = -1;
let sortAscending = true;
let posIndex = -1;

const columnDescriptions = {
  "B#": "NFL Expert Brandon Armstrong's Big Board Ranking",
  "C#": "Consensus Ranking according to NFLMockDraftDatabase.com",
  "Name": "Player's Name",
  "POS": "Player's Primary Position",
  "School": "The university out of which the player is being drafted",
  "Height": "Player's Height",
  "Weight": "Player's Weight in pounds",
  "Age": "Player's Draft Age",
  "PFN": "Impact Score according to ProFootballNetwork.com",
  "PFF": "Grade for most recently played season according to ProFootballFocus.com",
  "NFLDB": "Draft Prospect Grade according to NFLDraftBuzz.com",
  "AVG": "Average of PFN, PFF, & NFLDB",
  "GP": "Games Played",
  "Sacks": "Total Sacks",
  "S/G": "Sacks per Game",
  "TFL": "Tackles for Loss",
  "TFL/G": "Tackles for Loss per Game",
  "Tackles": "Combined Tackles",
  "T/G": "Tackles per Game",
  "PDe": "Passes Defended",
  "INTs": "Interceptions",
  "INT/G": "Interceptions per Game",
  "FF": "Forced Fumbles",
  "FF/G": "Forced Fumbles per Game"
};

Papa.parse(csvUrl, {
  download: true,
  complete: function(results) {

    headers = results.data[1];
    headers[0] = "B#";
    tableData = results.data.slice(2).filter(r => r.length > 1);

    posIndex = headers.findIndex(h =>
      h.toLowerCase().includes("pos")
    );

    createHeaders();
    populateFilter();
    displayRows();
  }
});

function createHeaders() {
  const thead = document.querySelector("#data-table thead");
  thead.innerHTML = "";
  const row = document.createElement("tr");

  headers.forEach((h, i) => {
    const th = document.createElement("th");

    const label = document.createElement("span");
    label.textContent = h;

    const arrow = document.createElement("span");
    arrow.className = "arrow";

    th.appendChild(label);
    th.appendChild(arrow);

    if (columnDescriptions[h]) {
      th.title = columnDescriptions[h];
    }

    th.onclick = () => {
      sortTable(i);
      updateArrows();
      highlightColumn();
    };

    row.appendChild(th);
  });

  thead.appendChild(row);
}

/* ✅ UPDATED HEIGHT PARSER */
function parseHeight(val){
  if(!val) return 0;

  val = val.toString().trim();

  // Handle 6-2, 6'2, 6 2
  let match = val.match(/(\d+)[-'\s](\d+)/);
  if(match){
    return parseInt(match[1]) * 12 + parseInt(match[2]);
  }

  // Handle decimal like 6.2 (6 feet 2 inches)
  if(val.includes(".")){
    let parts = val.split(".");
    let feet = parseInt(parts[0]);
    let inches = parseFloat(parts[1]);
    return feet * 12 + inches;
  }

  return parseFloat(val) || 0;
}

function sortTable(col) {
  if (currentSortColumn === col) {
    sortAscending = !sortAscending;
  } else {
    currentSortColumn = col;
    sortAscending = true;
  }

  tableData.sort((a,b)=>{
    let A = parseHeight(a[col]);
    let B = parseHeight(b[col]);

    if(typeof A === "number" && typeof B === "number"){
      return sortAscending ? A-B : B-A;
    }
    return sortAscending
      ? A.toString().localeCompare(B)
      : B.toString().localeCompare(A);
  });

  displayRows();
}

function updateArrows(){
  document.querySelectorAll("#data-table th").forEach((th,i)=>{
    const arrow = th.querySelector(".arrow");
    arrow.textContent = i===currentSortColumn
      ? (sortAscending ? "▲" : "▼")
      : "";
  });
}

function highlightColumn(){
  document.querySelectorAll("td, th").forEach(cell=>{
    cell.classList.remove("sorted-column");
  });

  if(currentSortColumn === -1) return;

  document.querySelectorAll("#data-table tr").forEach(row=>{
    if(row.children[currentSortColumn]){
      row.children[currentSortColumn].classList.add("sorted-column");
    }
  });
}

function populateFilter(){
  if(posIndex === -1) return;

  const set = new Set();
  tableData.forEach(r=>set.add(r[posIndex]));

  const filter = document.getElementById("positionFilter");

  set.forEach(p=>{
    const opt = document.createElement("option");
    opt.value = p;
    opt.textContent = p;
    filter.appendChild(opt);
  });

  filter.onchange = displayRows;
}

document.getElementById("searchBox").addEventListener("input", displayRows);

function displayRows(){
  const tbody = document.querySelector("#data-table tbody");
  tbody.innerHTML="";

  const pos = document.getElementById("positionFilter").value;
  const search = document.getElementById("searchBox").value.toLowerCase();

  tableData.forEach(r=>{
    if(posIndex !== -1 && pos !== "ALL" && r[posIndex] !== pos) return;
    if(search && !r.join(" ").toLowerCase().includes(search)) return;

    const tr=document.createElement("tr");

    r.forEach((c)=>{
      const td=document.createElement("td");
      td.textContent=c;
      tr.appendChild(td);
    });

    tbody.appendChild(tr);
  });

  highlightColumn();
}
</script>

</body>
</html>
